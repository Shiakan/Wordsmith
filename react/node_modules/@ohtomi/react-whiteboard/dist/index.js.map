{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap da915b2ce2d758cfaed1","webpack:///./src/Constants.js","webpack:///./src/EventStore.js","webpack:///./src/EventStream.js","webpack:///external \"react\"","webpack:///./src/SvgConverter.js","webpack:///./src/Whiteboard.js","webpack:///./src/CanvasPane.js","webpack:///./src/CursorPane.js","webpack:///./src/index.js","webpack:///./~/events/events.js"],"names":["MODE","HAND","DRAW_LINE","DRAG_IMAGE","NW_RESIZE_IMAGE","NE_RESIZE_IMAGE","SE_RESIZE_IMAGE","SW_RESIZE_IMAGE","SVG_ELEMENT_TYPE","LINE","IMAGE","Constants","EventStore","selectedLayer","renderableLayers","goodEvents","undoEvents","last","length","type","image","reduce","prev","element","forEach","p","push","layer","strokeWidth","strokeColor","values","point","event","map","filter","index","concat","move","lastImage","x","y","width","height","pop","EventStream","emitter","name","listener","on","emit","change","key","value","color","dataUrl","resizeType","SvgConverter","sourceNode","htmlText","outerHTML","base64EncodedText","window","btoa","encodeURIComponent","replace","match","p1","String","fromCharCode","parseInt","Promise","resolve","toDataUrl","imageType","toSvgData","then","svgdata","getBoundingClientRect","imageNode","Image","onload","canvasNode","document","createElement","graphicsContext","getContext","drawImage","Error","toDataURL","src","imageUrl","fromImageUrl","crossOrigin","Whiteboard","props","state","eventStore","mode","canvas","getSvgElement","setupEventHandler","events","selectLayer","bind","addLayer","startDrawing","stopDrawing","changeStrokeWidth","changeStrokeColor","pushPoint","pasteImage","startDragging","stopDragging","dragImage","startResizing","stopResizing","resizeImage","undo","redo","clear","setState","nwResizeImage","neResizeImage","seResizeImage","swResizeImage","wrapperStyle","position","Object","assign","Component","defaultProps","style","backgroundColor","CanvasPane","svgElement","canvasLayerStyle","drawWhiteboardCanvas","drawImageBorder","reduceEvents","d","join","CursorPane","dragStart","resizeStart","ev","eventToPoint","nativeEvent","offsetX","offsetY","target","dragHandle","base","unit","Math","ceil","moveX","moveY","pageX","pageY","preventDefault","stopPropagation","cursorLayerStyle","zIndex","borderStyle","borderColor","onClickCursorLayer","onMouseMoveCursorLayer","renderImageHandle","mathMinOrMax","min","max","top","bottom","left","right","dragHandleStyle","cursor","nwResizeHandleStyle","neResizeHandleStyle","seResizeHandleStyle","swResizeHandleStyle","onClickDragHandle","onClickResizeHandle","module","exports"],"mappings":"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B,MAAK,cAA1B,EAAyC,OAAO8K,mBAAhD;AACK,yBAAS,KAAKE,mBAAL,CAAyB/E,IAAzB,CAA8B,IAA9B,EAAoC5F,UAAUX,IAAV,CAAeO,eAAnD,CADd,GATI,CAAR;AAYH;;;;EArNmC,gBAAM0H,S;;kBAAzBY,U;;;;;;;;;AC/BrB;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;IAAYlI,S;;;;;;AAGZ4K,OAAOC,OAAP,GAAiB;AACb3F,oCADa;AAEbjD,sCAFa;AAGbhC,oCAHa;AAIb4C,wCAJa;AAKb7C;AALa,CAAjB,C;;;;;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,eAAe,SAAS;AACxB;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH,oBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ReactWhiteboard\"] = factory(require(\"react\"));\n\telse\n\t\troot[\"ReactWhiteboard\"] = factory(root[\"react\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_3__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap da915b2ce2d758cfaed1","// @flow\n\nexport const MODE = {\n    HAND: 'HAND',\n    DRAW_LINE: 'DRAW_LINE',\n    DRAG_IMAGE: 'DRAG_IMAGE',\n    NW_RESIZE_IMAGE: 'NW_RESIZE_IMAGE',\n    NE_RESIZE_IMAGE: 'NE_RESIZE_IMAGE',\n    SE_RESIZE_IMAGE: 'SE_RESIZE_IMAGE',\n    SW_RESIZE_IMAGE: 'SW_RESIZE_IMAGE'\n};\n\nexport const SVG_ELEMENT_TYPE = {\n    LINE: 'LINE',\n    IMAGE: 'IMAGE'\n};\n\nexport type ModeType =\n    typeof MODE.HAND |\n    typeof MODE.DRAW_LINE |\n    typeof MODE.DRAG_IMAGE |\n    typeof MODE.NW_RESIZE_IMAGE |\n    typeof MODE.NE_RESIZE_IMAGE |\n    typeof MODE.SE_RESIZE_IMAGE |\n    typeof MODE.SW_RESIZE_IMAGE;\n\nexport type ResizeType =\n    typeof MODE.NW_RESIZE_IMAGE |\n    typeof MODE.NE_RESIZE_IMAGE |\n    typeof MODE.SE_RESIZE_IMAGE |\n    typeof MODE.SW_RESIZE_IMAGE;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Constants.js","// @flow\n\nimport * as Constants from './Constants';\n\n\nexport type PointDataType = {\n    x: number,\n    y: number\n};\n\nexport type ImageDataType = {\n    x?: number,\n    y?: number,\n    width: number,\n    height: number,\n    dataUrl: string\n};\n\nexport type MoveDataType = {\n    x: number,\n    y: number\n};\n\nexport type PointEventType = {\n    type: typeof Constants.SVG_ELEMENT_TYPE.LINE,\n    layer: number,\n    strokeWidth: number,\n    strokeColor: string,\n    point: PointDataType\n};\n\nexport type ImageEventType = {\n    type: typeof Constants.SVG_ELEMENT_TYPE.IMAGE,\n    layer: number,\n    image: ImageDataType\n};\n\nexport type StopEventType = {\n    type?: null\n};\n\nexport type AnyEventType = PointEventType | ImageEventType | StopEventType;\n\nexport type ReducedLineEventType = {\n    type: typeof Constants.SVG_ELEMENT_TYPE.LINE,\n    strokeWidth: number,\n    strokeColor: string,\n    values: Array<PointDataType>\n};\n\nexport type ReducedImageEventType = {\n    type: typeof Constants.SVG_ELEMENT_TYPE.IMAGE,\n    image: ImageDataType\n};\n\nexport type ReducedStopEventType = {\n    type?: null\n};\n\nexport type AnyReducedEventType = ReducedLineEventType | ReducedImageEventType | ReducedStopEventType;\n\nexport default class EventStore {\n\n    selectedLayer: number;\n    renderableLayers: Array<boolean>;\n    goodEvents: Array<AnyEventType>;\n    undoEvents: Array<AnyEventType>;\n\n    constructor() {\n        this.selectedLayer = 0;\n        this.renderableLayers = [true];\n        this.goodEvents = [];\n        this.undoEvents = [];\n    }\n\n    lastImage(): ?ImageDataType {\n        const last = this.goodEvents[this.goodEvents.length - 1];\n        if (last && last.type === Constants.SVG_ELEMENT_TYPE.IMAGE) {\n            return last.image;\n        } else {\n            return null;\n        }\n    }\n\n    reduceEvents(): Array<AnyReducedEventType> {\n        return this.goodEvents.reduce((prev: Array<Array<AnyReducedEventType>>, element: AnyEventType): Array<Array<AnyReducedEventType>> => {\n                if (!element.type) {\n                    prev.forEach(p => {\n                        p.push({});\n                    });\n                    return prev;\n                }\n\n                if (element.type === Constants.SVG_ELEMENT_TYPE.LINE) {\n                    let last = prev[element.layer][prev[element.layer].length - 1];\n                    if (last && last.type === Constants.SVG_ELEMENT_TYPE.LINE && last.strokeWidth === element.strokeWidth && last.strokeColor === element.strokeColor) {\n                        last.values.push(element.point);\n                    } else {\n                        const event: ReducedLineEventType = {\n                            type: element.type,\n                            strokeWidth: element.strokeWidth,\n                            strokeColor: element.strokeColor,\n                            values: [element.point]\n                        };\n                        prev[element.layer].push(event);\n                    }\n                    return prev;\n\n                } else if (element.type === Constants.SVG_ELEMENT_TYPE.IMAGE) {\n                    const event: ReducedImageEventType = {\n                        type: element.type,\n                        image: element.image\n                    };\n                    prev[element.layer].push(event);\n                    return prev;\n\n                } else {\n                    return prev;\n                }\n\n            }, this.renderableLayers.map(() => [])\n        ).filter((element: Array<AnyReducedEventType>, index: number): boolean => {\n            return this.renderableLayers[index];\n\n        }).reduce((prev: Array<AnyReducedEventType>, element: Array<AnyReducedEventType>): Array<AnyReducedEventType> => {\n                return prev.concat(element);\n\n            }, []\n        ).filter((element: AnyReducedEventType): boolean => {\n            if (element.type === Constants.SVG_ELEMENT_TYPE.LINE) {\n                return element.values.length > 1;\n            } else if (element.type === Constants.SVG_ELEMENT_TYPE.IMAGE) {\n                return true;\n            } else {\n                return true;\n            }\n        });\n    }\n\n    selectLayer(layer: number) {\n        this.goodEvents.push({});\n        this.selectedLayer = layer;\n    }\n\n    addLayer() {\n        this.renderableLayers.push(true);\n    }\n\n    startDrawing(strokeWidth: number, strokeColor: string, point: PointDataType) {\n        this.goodEvents.push({\n            type: Constants.SVG_ELEMENT_TYPE.LINE,\n            layer: this.selectedLayer,\n            strokeWidth: strokeWidth,\n            strokeColor: strokeColor,\n            point: point\n        });\n    }\n\n    stopDrawing() {\n        this.goodEvents.push({});\n    }\n\n    pushPoint(strokeWidth: number, strokeColor: string, point: PointDataType) {\n        const event: PointEventType = {\n            type: Constants.SVG_ELEMENT_TYPE.LINE,\n            layer: this.selectedLayer,\n            strokeWidth: strokeWidth,\n            strokeColor: strokeColor,\n            point: point\n        };\n        this.goodEvents.push(event);\n        this.undoEvents = [];\n    }\n\n    pasteImage(image: ImageDataType) {\n        const event: ImageEventType = {\n            type: Constants.SVG_ELEMENT_TYPE.IMAGE,\n            layer: this.selectedLayer,\n            image: image\n        };\n        this.goodEvents.push(event);\n        this.undoEvents = [];\n    }\n\n    dragImage(move: MoveDataType) {\n        const lastImage = this.lastImage();\n        if (lastImage) {\n            lastImage.x = lastImage.x + move.x;\n            lastImage.y = lastImage.y + move.y;\n        }\n    }\n\n    nwResizeImage(move: MoveDataType) {\n        const lastImage = this.lastImage();\n        if (lastImage) {\n            lastImage.x = lastImage.x + move.x;\n            lastImage.y = lastImage.y + move.y;\n            lastImage.width = lastImage.width - move.x;\n            lastImage.height = lastImage.height - move.y;\n        }\n    }\n\n    neResizeImage(move: MoveDataType) {\n        const lastImage = this.lastImage();\n        if (lastImage) {\n            // lastImage.x = lastImage.x + move.x;\n            lastImage.y = lastImage.y + move.y;\n            lastImage.width = lastImage.width + move.x;\n            lastImage.height = lastImage.height - move.y;\n        }\n    }\n\n    seResizeImage(move: MoveDataType) {\n        const lastImage = this.lastImage();\n        if (lastImage) {\n            // lastImage.x = lastImage.x + move.x;\n            // lastImage.y = lastImage.y + move.y;\n            lastImage.width = lastImage.width + move.x;\n            lastImage.height = lastImage.height + move.y;\n        }\n    }\n\n    swResizeImage(move: MoveDataType) {\n        const lastImage = this.lastImage();\n        if (lastImage) {\n            lastImage.x = lastImage.x + move.x;\n            // lastImage.y = lastImage.y + move.y;\n            lastImage.width = lastImage.width - move.x;\n            lastImage.height = lastImage.height + move.y;\n        }\n    }\n\n    undo() {\n        if (this.goodEvents.length) {\n            this.undoEvents.push(this.goodEvents.pop()); // {}\n            this.undoEvents.push(this.goodEvents.pop()); // {type: 'line', point: [...], ...} or {type: 'image', image: {...}, ...}\n            this.goodEvents.push({});\n        }\n    }\n\n    redo() {\n        if (this.undoEvents.length) {\n            this.goodEvents.pop();\n            this.goodEvents.push(this.undoEvents.pop()); // {type: 'line', point: [...], ...} or {type: 'image', image: {...}, ...}\n            this.goodEvents.push(this.undoEvents.pop()); // {}\n        }\n    }\n\n    clear() {\n        this.goodEvents = [];\n        this.undoEvents = [];\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/EventStore.js","// @flow\n\nimport EventEmitter from 'events';\nimport type {ResizeType} from \"./Constants\";\nimport type {ImageDataType, MoveDataType, PointDataType} from \"./EventStore\";\n\n\ntype listenerType = (any) => void;\n\nexport type StrokeWidthType = {\n    key: 'strokeWidth',\n    value: number\n};\n\nexport type StrokeColorType = {\n    key: 'strokeColor',\n    value: string\n};\n\nexport default class EventStream {\n\n    emitter: EventEmitter;\n\n    constructor() {\n        this.emitter = new EventEmitter();\n    }\n\n    on(name: string, listener: listenerType) {\n        this.emitter.on(name, listener);\n    }\n\n    selectLayer(layer: number) {\n        this.emitter.emit('selectLayer', layer);\n    }\n\n    addLayer() {\n        this.emitter.emit('addLayer');\n    }\n\n    startDrawing(x: number, y: number) {\n        this.emitter.emit('start', {x: x, y: y});\n    }\n\n    stopDrawing() {\n        this.emitter.emit('stop');\n    }\n\n    changeStrokeWidth(width: number) {\n        const change: StrokeWidthType = {key: 'strokeWidth', value: width};\n        this.emitter.emit('set', change);\n    }\n\n    changeStrokeColor(color: string) {\n        const change: StrokeColorType = {key: 'strokeColor', value: color};\n        this.emitter.emit('set', change);\n    }\n\n    pushPoint(x: number, y: number) {\n        const point: PointDataType = {x: x, y: y};\n        this.emitter.emit('push', point);\n    }\n\n    pasteImage(x: number, y: number, width: number, height: number, dataUrl: string) {\n        const image: ImageDataType = {x: x, y: y, width: width, height: height, dataUrl: dataUrl};\n        this.emitter.emit('paste', image);\n    }\n\n    startDragging() {\n        this.emitter.emit('startDragging');\n    }\n\n    stopDragging() {\n        this.emitter.emit('stopDragging');\n    }\n\n    dragImage(x: number, y: number) {\n        const move: MoveDataType = {x: x, y: y};\n        this.emitter.emit('drag', move);\n    }\n\n    startResizing(resizeType: ResizeType) {\n        this.emitter.emit('startResizing', resizeType);\n    }\n\n    stopResizing() {\n        this.emitter.emit('stopResizing');\n    }\n\n    resizeImage(x: number, y: number) {\n        const move: MoveDataType = {x: x, y: y};\n        this.emitter.emit('resize', move);\n    }\n\n    undo() {\n        this.emitter.emit('undo');\n    }\n\n    redo() {\n        this.emitter.emit('redo');\n    }\n\n    clear() {\n        this.emitter.emit('clear');\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/EventStream.js","module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = 3\n// module chunks = 0","// @flow\n\nimport type {ImageDataType} from \"./EventStore\";\n\n\nexport default class SvgConverter {\n\n    static toSvgData(sourceNode: HTMLElement): Promise<string> {\n        let htmlText = sourceNode.outerHTML;\n        let base64EncodedText = window.btoa(\n            window.encodeURIComponent(htmlText)\n                .replace(/%([0-9A-F]{2})/g, (match: string, p1: string): string => String.fromCharCode(window.parseInt('0x' + p1))));\n\n        return new Promise(resolve => {\n            resolve('data:image/svg+xml;charset=utf-8;base64,' + base64EncodedText);\n        });\n    }\n\n    static toPngData(sourceNode: HTMLElement): Promise<string> {\n        return SvgConverter.toDataUrl(sourceNode, 'image/png');\n    }\n\n    static toJpegData(sourceNode: HTMLElement): Promise<string> {\n        return SvgConverter.toDataUrl(sourceNode, 'image/jpeg');\n    }\n\n    static toDataUrl(sourceNode: HTMLElement, imageType: string): Promise<string> {\n        return new Promise(resolve => {\n            SvgConverter.toSvgData(sourceNode).then((svgdata: string) => {\n                let {width, height} = sourceNode.getBoundingClientRect();\n\n                let imageNode = new window.Image();\n                imageNode.onload = () => {\n                    let canvasNode = document.createElement('canvas');\n                    canvasNode.width = width;\n                    canvasNode.height = height;\n\n                    let graphicsContext = canvasNode.getContext('2d');\n                    if (graphicsContext) {\n                        graphicsContext.drawImage(imageNode, 0, 0);\n                    } else {\n                        throw new Error('got no rendering context');\n                    }\n\n                    resolve(canvasNode.toDataURL(imageType));\n                };\n                imageNode.src = svgdata;\n            });\n        });\n    }\n\n    static fromPngImage(imageUrl: string): Promise<ImageDataType> {\n        return SvgConverter.fromImageUrl(imageUrl, 'image/png');\n    }\n\n    static fromJpegImage(imageUrl: string): Promise<ImageDataType> {\n        return SvgConverter.fromImageUrl(imageUrl, 'image/jpeg');\n    }\n\n    static fromGifImage(imageUrl: string): Promise<ImageDataType> {\n        return SvgConverter.fromImageUrl(imageUrl, 'image/gif');\n    }\n\n    static fromImageUrl(imageUrl: string, imageType: string): Promise<ImageDataType> {\n        return new Promise(resolve => {\n            let imageNode = new window.Image();\n            imageNode.onload = () => {\n                let canvasNode = document.createElement('canvas');\n                canvasNode.width = imageNode.width;\n                canvasNode.height = imageNode.height;\n\n                let graphicsContext = canvasNode.getContext('2d');\n                if (graphicsContext) {\n                    graphicsContext.drawImage(imageNode, 0, 0);\n                } else {\n                    throw new Error('got no rendering context');\n                }\n\n                resolve({width: imageNode.width, height: imageNode.height, dataUrl: canvasNode.toDataURL(imageType)});\n            };\n            imageNode.crossOrigin = 'anonymous';\n            imageNode.src = imageUrl;\n        });\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/SvgConverter.js","// @flow\n\nimport React from 'react';\n\nimport * as Constants from './Constants';\nimport EventStream from './EventStream';\nimport EventStore from './EventStore';\nimport CursorPane from './CursorPane';\nimport CanvasPane from './CanvasPane';\nimport type {ModeType, ResizeType} from \"./Constants\";\nimport type {StrokeColorType, StrokeWidthType} from \"./EventStream\";\nimport type {ImageDataType, MoveDataType, PointDataType} from \"./EventStore\";\n\n\ntype defaultPropsType = {\n    events: EventStream,\n    eventStore: EventStore,\n    width: number,\n    height: number,\n    style: {\n        backgroundColor: string\n    }\n};\n\ntype propsType = {\n    events: EventStream,\n    eventStore: EventStore,\n    width: number,\n    height: number,\n    style: {\n        backgroundColor: string\n    }\n};\n\ntype stateType = {\n    eventStore: EventStore,\n    mode: ModeType,\n    layer: number,\n    strokeWidth: number,\n    strokeColor: string\n};\n\nexport default class Whiteboard extends React.Component {\n\n    static defaultProps: defaultPropsType;\n    props: propsType;\n    state: stateType;\n\n    canvas: ?CanvasPane;\n\n    constructor(props: propsType) {\n        super(props);\n\n        this.state = {\n            eventStore: props.eventStore,\n            mode: Constants.MODE.HAND,\n            layer: 0,\n            strokeWidth: 5,\n            strokeColor: 'black'\n        };\n\n        this.canvas = null;\n    }\n\n    getSvgElement(): ?HTMLElement {\n        if (this.canvas) {\n            return this.canvas.getSvgElement();\n        }\n    }\n\n    componentDidMount() {\n        this.setupEventHandler();\n    }\n\n    setupEventHandler() {\n        this.props.events.on('selectLayer', this.selectLayer.bind(this));\n        this.props.events.on('addLayer', this.addLayer.bind(this));\n\n        this.props.events.on('start', this.startDrawing.bind(this));\n        this.props.events.on('stop', this.stopDrawing.bind(this));\n\n        this.props.events.on('set', (event: StrokeWidthType | StrokeColorType) => {\n            if (event.key === 'strokeWidth') {\n                this.changeStrokeWidth(event.value);\n            }\n            if (event.key === 'strokeColor') {\n                this.changeStrokeColor(event.value);\n            }\n        });\n\n        this.props.events.on('push', this.pushPoint.bind(this));\n\n        this.props.events.on('paste', this.pasteImage.bind(this));\n        this.props.events.on('startDragging', this.startDragging.bind(this));\n        this.props.events.on('stopDragging', this.stopDragging.bind(this));\n        this.props.events.on('drag', this.dragImage.bind(this));\n        this.props.events.on('startResizing', this.startResizing.bind(this));\n        this.props.events.on('stopResizing', this.stopResizing.bind(this));\n        this.props.events.on('resize', this.resizeImage.bind(this));\n\n        this.props.events.on('undo', this.undo.bind(this));\n        this.props.events.on('redo', this.redo.bind(this));\n        this.props.events.on('clear', this.clear.bind(this));\n    }\n\n    selectLayer(layer: number) {\n        this.state.eventStore.selectLayer(layer);\n        this.setState({\n            layer: layer,\n            eventStore: this.state.eventStore\n        });\n    }\n\n    addLayer() {\n        this.state.eventStore.addLayer();\n        this.setState({eventStore: this.state.eventStore});\n    }\n\n    startDrawing(point: PointDataType) {\n        this.state.eventStore.startDrawing(this.state.strokeWidth, this.state.strokeColor, point);\n        this.setState({\n            mode: Constants.MODE.DRAW_LINE,\n            eventStore: this.state.eventStore\n        });\n    }\n\n    stopDrawing() {\n        this.state.eventStore.stopDrawing();\n        this.setState({\n            mode: Constants.MODE.HAND,\n            eventStore: this.state.eventStore\n        });\n    }\n\n    changeStrokeWidth(width: number) {\n        this.state.eventStore.stopDrawing();\n        this.setState({\n            strokeWidth: width,\n            eventStore: this.state.eventStore\n        });\n    }\n\n    changeStrokeColor(color: string) {\n        this.state.eventStore.stopDrawing();\n        this.setState({\n            strokeColor: color,\n            eventStore: this.state.eventStore\n        });\n    }\n\n    pushPoint(point: PointDataType) {\n        this.state.eventStore.pushPoint(this.state.strokeWidth, this.state.strokeColor, point);\n        this.setState({eventStore: this.state.eventStore});\n    }\n\n    pasteImage(image: ImageDataType) {\n        this.state.eventStore.pasteImage(image);\n        this.setState({eventStore: this.state.eventStore});\n    }\n\n    startDragging() {\n        this.setState({mode: Constants.MODE.DRAG_IMAGE});\n    }\n\n    stopDragging() {\n        this.setState({mode: Constants.MODE.HAND});\n    }\n\n    dragImage(move: MoveDataType) {\n        if (this.state.mode !== Constants.MODE.DRAG_IMAGE) {\n            return;\n        }\n\n        this.state.eventStore.dragImage(move);\n        this.setState({eventStore: this.state.eventStore});\n    }\n\n    startResizing(resizeType: ResizeType) {\n        this.setState({mode: resizeType});\n    }\n\n    stopResizing() {\n        this.setState({mode: Constants.MODE.HAND});\n    }\n\n    resizeImage(move: MoveDataType) {\n        if (this.state.mode === Constants.MODE.NW_RESIZE_IMAGE) {\n            this.state.eventStore.nwResizeImage(move);\n            this.setState({eventStore: this.state.eventStore});\n        } else if (this.state.mode === Constants.MODE.NE_RESIZE_IMAGE) {\n            this.state.eventStore.neResizeImage(move);\n            this.setState({\n                eventStore: this.state.eventStore,\n            });\n        } else if (this.state.mode === Constants.MODE.SE_RESIZE_IMAGE) {\n            this.state.eventStore.seResizeImage(move);\n            this.setState({\n                eventStore: this.state.eventStore,\n            });\n        } else if (this.state.mode === Constants.MODE.SW_RESIZE_IMAGE) {\n            this.state.eventStore.swResizeImage(move);\n            this.setState({eventStore: this.state.eventStore});\n        }\n    }\n\n    undo() {\n        this.state.eventStore.undo();\n        this.setState({eventStore: this.state.eventStore});\n    }\n\n    redo() {\n        this.state.eventStore.redo();\n        this.setState({eventStore: this.state.eventStore});\n    }\n\n    clear() {\n        this.state.eventStore.clear();\n        this.setState({eventStore: this.state.eventStore});\n    }\n\n    render() {\n        const wrapperStyle = {\n            position: 'relative',\n            width: this.props.width,\n            height: this.props.height\n        };\n\n        const props = Object.assign({}, this.props, this.state);\n\n        return (\n            <div style={wrapperStyle}>\n                <CursorPane {...props}/>\n                <CanvasPane ref={canvas => this.canvas = canvas} {...props}/>\n            </div>\n        );\n    }\n}\n\nWhiteboard.defaultProps = {\n    events: new EventStream(),\n    eventStore: new EventStore(),\n    width: 400,\n    height: 400,\n    style: {\n        backgroundColor: 'none'\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/Whiteboard.js","// @flow\n\nimport React from 'react';\n\nimport * as Constants from './Constants';\nimport EventStore from \"./EventStore\";\nimport type {AnyReducedEventType, ImageDataType, PointDataType} from \"./EventStore\";\n\n\ntype propsType = {\n    eventStore: EventStore,\n    width: number,\n    height: number,\n    style: {\n        backgroundColor: string\n    }\n};\n\ntype stateType = {};\n\nexport default class CanvasPane extends React.Component {\n\n    props: propsType;\n    state: stateType;\n\n    svgElement: ?HTMLElement;\n\n    constructor(props: propsType) {\n        super(props);\n\n        this.svgElement = null;\n    }\n\n    getSvgElement(): ?HTMLElement {\n        return this.svgElement;\n    }\n\n    render() {\n        const canvasLayerStyle = {\n            position: 'absolute',\n            width: this.props.width,\n            height: this.props.height\n        };\n\n        return (\n            <div style={canvasLayerStyle}>\n                <svg ref={element => this.svgElement = element}\n                     version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n                     width={this.props.width} height={this.props.height}>\n                    <rect width={'100%'} height={'100%'} fill={this.props.style.backgroundColor}/>\n                    {this.drawWhiteboardCanvas()}\n                    {this.drawImageBorder()}\n                </svg>\n            </div>\n        );\n    }\n\n    drawWhiteboardCanvas(): Array<?React$Element<any>> {\n        return this.props.eventStore.reduceEvents().map((element: AnyReducedEventType, index: number): ?React$Element<any> => {\n            if (element.type === Constants.SVG_ELEMENT_TYPE.LINE) {\n                const key = index;\n                const d = element.values.map((point: PointDataType, index: number) => {\n                    if (index === 0) {\n                        return 'M ' + point.x + ' ' + point.y;\n                    } else {\n                        return 'L ' + point.x + ' ' + point.y;\n                    }\n                });\n\n                return (\n                    <path key={key} d={d.join(' ')} fill=\"none\" stroke={element.strokeColor} strokeWidth={element.strokeWidth}/>\n                );\n\n            } else if (element.type === Constants.SVG_ELEMENT_TYPE.IMAGE) {\n                const key = index;\n                const image: ImageDataType = element.image;\n\n                return (\n                    <image key={key} x={image.x} y={image.y} width={image.width} height={image.height} xlinkHref={image.dataUrl}/>\n                );\n\n            } else {\n                return null;\n            }\n        });\n    }\n\n    drawImageBorder(): ?React$Element<any> {\n        const lastImage = this.props.eventStore.lastImage();\n        if (!lastImage) {\n            return null;\n        }\n\n        return (\n            <rect x={lastImage.x} y={lastImage.y} width={lastImage.width} height={lastImage.height}\n                  fill={'none'} stroke={'black'} strokeDasharray={'5,5'}/>\n        );\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/CanvasPane.js","// @flow\n\nimport React from 'react';\n\nimport * as Constants from './Constants';\nimport EventStream from './EventStream';\nimport EventStore from \"./EventStore\";\nimport type {ModeType, ResizeType} from \"./Constants\";\nimport type {PointDataType} from \"./EventStore\";\n\n\ntype propsType = {\n    events: EventStream,\n    eventStore: EventStore,\n    width: number,\n    height: number,\n    mode: ModeType,\n    strokeWidth: number,\n    strokeColor: string\n};\n\ntype stateType = {\n    dragStart: ?PointDataType,\n    resizeStart: ?PointDataType\n};\n\ntype mouseEventType = SyntheticMouseEvent & {\n    nativeEvent: {\n        offsetX: number,\n        offsetY: number\n    }\n};\n\nexport default class CursorPane extends React.Component {\n\n    props: propsType;\n    state: stateType;\n\n    dragHandle: ?HTMLElement;\n\n    constructor(props: propsType) {\n        super(props);\n\n        this.state = {\n            dragStart: null,\n            resizeStart: null,\n        };\n    }\n\n    onClickCursorLayer(ev: mouseEventType) {\n        let eventToPoint = (ev: mouseEventType): Array<number> => {\n            const x = ev.nativeEvent.offsetX - 2;\n            const y = ev.nativeEvent.offsetY + (2 * (this.props.strokeWidth / 3));\n            return [x, y];\n        };\n\n        if (this.props.mode === Constants.MODE.HAND) {\n            this.props.events.startDrawing(...eventToPoint(ev));\n        } else {\n            this.props.events.stopDrawing();\n        }\n    }\n\n    onMouseMoveCursorLayer(ev: mouseEventType) {\n        let eventToPoint = (ev: mouseEventType): Array<number> => {\n            const x = ev.nativeEvent.offsetX - 2;\n            const y = ev.nativeEvent.offsetY + (2 * (this.props.strokeWidth / 3));\n            return [x, y];\n        };\n\n        if (this.props.mode === Constants.MODE.DRAW_LINE) {\n            this.props.events.pushPoint(...eventToPoint(ev));\n        } else if (this.props.mode === Constants.MODE.DRAG_IMAGE) {\n            if (ev.target !== this.dragHandle) {\n                return;\n            }\n\n            const lastImage = this.props.eventStore.lastImage();\n            if (!lastImage) {\n                return;\n            }\n\n            if (this.state.dragStart) {\n                const base = (lastImage.width < lastImage.height) ? lastImage.width : lastImage.height;\n                const unit = (base / 8) < 20 ? Math.ceil(base / 8) : 20;\n\n                const moveX = lastImage.x + unit < 0 ? ev.nativeEvent.offsetX - this.state.dragStart.x - (lastImage.x + unit) : ev.nativeEvent.offsetX - this.state.dragStart.x;\n                const moveY = lastImage.y + unit < 0 ? ev.nativeEvent.offsetY - this.state.dragStart.y - (lastImage.y + unit) : ev.nativeEvent.offsetY - this.state.dragStart.y;\n\n                this.props.events.dragImage(moveX, moveY);\n            }\n        } else if (this.props.mode === Constants.MODE.NW_RESIZE_IMAGE || this.props.mode === Constants.MODE.NE_RESIZE_IMAGE || this.props.mode === Constants.MODE.SE_RESIZE_IMAGE || this.props.mode === Constants.MODE.SW_RESIZE_IMAGE) {\n            const lastImage = this.props.eventStore.lastImage();\n            if (!lastImage) {\n                return;\n            }\n\n            if (this.state.resizeStart) {\n                const moveX = ev.pageX - this.state.resizeStart.x;\n                const moveY = ev.pageY - this.state.resizeStart.y;\n\n                // do nothing if cannot resize image\n                if (this.props.mode === Constants.MODE.NW_RESIZE_IMAGE && (lastImage.width - moveX < 0 || lastImage.height - moveY < 0 )) {\n                    return;\n                } else if (this.props.mode === Constants.MODE.NE_RESIZE_IMAGE && (lastImage.width + moveX < 0 || lastImage.height - moveY < 0 )) {\n                    return;\n                } else if (this.props.mode === Constants.MODE.SE_RESIZE_IMAGE && (lastImage.width + moveX < 0 || lastImage.height + moveY < 0 )) {\n                    return;\n                } else if (this.props.mode === Constants.MODE.SW_RESIZE_IMAGE && (lastImage.width - moveX < 0 || lastImage.height + moveY < 0 )) {\n                    return;\n                }\n\n                this.setState({resizeStart: {x: ev.pageX, y: ev.pageY}});\n                this.props.events.resizeImage(moveX, moveY);\n            }\n        }\n    }\n\n    onClickDragHandle(ev: mouseEventType) {\n        if (this.props.mode === Constants.MODE.HAND) {\n            this.setState({dragStart: {x: ev.nativeEvent.offsetX, y: ev.nativeEvent.offsetY}});\n            this.props.events.startDragging();\n        } else {\n            this.setState({dragStart: null});\n            this.props.events.stopDragging();\n        }\n        ev.preventDefault();\n        ev.stopPropagation();\n    }\n\n    onClickResizeHandle(resizeType: ResizeType, ev: mouseEventType) {\n        if (this.props.mode === Constants.MODE.HAND) {\n            this.setState({resizeStart: {x: ev.pageX, y: ev.pageY}});\n            this.props.events.startResizing(resizeType);\n        } else {\n            this.setState({resizeStart: null});\n            this.props.events.stopResizing();\n        }\n        ev.preventDefault();\n        ev.stopPropagation();\n    }\n\n    render() {\n        const cursorLayerStyle = {\n            position: 'absolute',\n            zIndex: 2000,\n            width: this.props.width,\n            height: this.props.height,\n            borderStyle: 'none none solid none',\n            borderColor: this.props.strokeColor,\n        };\n\n        return (\n            <div role=\"presentation\" style={cursorLayerStyle}\n                 onClick={this.onClickCursorLayer.bind(this)} onMouseMove={this.onMouseMoveCursorLayer.bind(this)}>\n                {this.renderImageHandle()}\n            </div>\n        );\n    }\n\n    renderImageHandle(): ?Array<React$Element<any>> {\n        const lastImage = this.props.eventStore.lastImage();\n        if (!lastImage) {\n            return null;\n        }\n\n        const base = (lastImage.width < lastImage.height) ? lastImage.width : lastImage.height;\n        const unit = (base / 8) < 20 ? Math.ceil(base / 8) : 20;\n\n        const mathMinOrMax = (min: number, max: number, value: number): number => {\n            if (value < min) {\n                return min;\n            } else if (value > max) {\n                return max;\n            } else {\n                return value;\n            }\n        };\n\n        const top = mathMinOrMax(0, this.props.height, lastImage.y + unit);\n        const bottom = mathMinOrMax(0, this.props.height, lastImage.y + lastImage.height - unit);\n        const left = mathMinOrMax(0, this.props.width, lastImage.x + unit);\n        const right = mathMinOrMax(0, this.props.width, lastImage.x + lastImage.width - unit);\n\n        const dragHandleStyle = {\n            position: 'absolute',\n            zIndex: 2500,\n            top: top,\n            left: left,\n            width: right - left,\n            height: bottom - top,\n            cursor: 'move',\n        };\n\n        const nwResizeHandleStyle = {\n            position: 'absolute',\n            zIndex: 2500,\n            top: mathMinOrMax(0, this.props.height, top - unit),\n            left: mathMinOrMax(0, this.props.width, left - unit),\n            width: left - mathMinOrMax(0, this.props.width, left - unit),\n            height: top - mathMinOrMax(0, this.props.height, top - unit),\n            cursor: 'nw-resize',\n        };\n\n        const neResizeHandleStyle = {\n            position: 'absolute',\n            zIndex: 2500,\n            top: mathMinOrMax(0, this.props.height, top - unit),\n            left: right,\n            width: mathMinOrMax(0, this.props.width, right + unit) - right,\n            height: top - mathMinOrMax(0, this.props.height, top - unit),\n            cursor: 'ne-resize',\n        };\n\n        const seResizeHandleStyle = {\n            position: 'absolute',\n            zIndex: 2500,\n            top: bottom,\n            left: right,\n            width: mathMinOrMax(0, this.props.width, right + unit) - right,\n            height: mathMinOrMax(0, this.props.height, bottom + unit) - bottom,\n            cursor: 'se-resize',\n        };\n\n        const swResizeHandleStyle = {\n            position: 'absolute',\n            zIndex: 2500,\n            top: bottom,\n            left: mathMinOrMax(0, this.props.width, left - unit),\n            width: left - mathMinOrMax(0, this.props.width, left - unit),\n            height: mathMinOrMax(0, this.props.height, bottom + unit) - bottom,\n            cursor: 'sw-resize',\n        };\n\n        return ([\n            <div key=\"drag\" role=\"presentation\" style={dragHandleStyle}\n                 ref={dragHandle => this.dragHandle = dragHandle} onClick={this.onClickDragHandle.bind(this)}/>,\n            <div key=\"nw-resize\" role=\"presentation\" style={nwResizeHandleStyle}\n                 onClick={this.onClickResizeHandle.bind(this, Constants.MODE.NW_RESIZE_IMAGE)}/>,\n            <div key=\"ne-resize\" role=\"presentation\" style={neResizeHandleStyle}\n                 onClick={this.onClickResizeHandle.bind(this, Constants.MODE.NE_RESIZE_IMAGE)}/>,\n            <div key=\"se-resize\" role=\"presentation\" style={seResizeHandleStyle}\n                 onClick={this.onClickResizeHandle.bind(this, Constants.MODE.SE_RESIZE_IMAGE)}/>,\n            <div key=\"sw-resize\" role=\"presentation\" style={swResizeHandleStyle}\n                 onClick={this.onClickResizeHandle.bind(this, Constants.MODE.SW_RESIZE_IMAGE)}/>\n        ]);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/CursorPane.js","// @flow\n\nimport Whiteboard from './Whiteboard';\nimport EventStream from './EventStream';\nimport EventStore from './EventStore';\nimport SvgConverter from './SvgConverter';\nimport * as Constants from './Constants';\n\n\nmodule.exports = {\n    Whiteboard,\n    EventStream,\n    EventStore,\n    SvgConverter,\n    Constants\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/events/events.js\n// module id = 9\n// module chunks = 0"],"sourceRoot":""}